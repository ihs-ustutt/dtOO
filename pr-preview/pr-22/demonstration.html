

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demonstration &mdash; dtOO  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="C++ API documentation" href="api.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/dtoo-logo-inv-nbg.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Demonstration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#kinetic-turbine-canada">Kinetic Turbine <code class="docutils literal notranslate"><span class="pre">canada</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parameterization">Parameterization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parameter-symbols-and-labels">Parameter symbols and labels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#simulation-setup">Simulation setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-case">Running the case</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-build-py">Using <code class="docutils literal notranslate"><span class="pre">build.py</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-an-own-state">Creating an own state</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydFoilOpt.build">Optimization of a Hydrofoil</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hydFoilOpt.build.hydFoil"><code class="docutils literal notranslate"><span class="pre">hydFoil</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.Evaluate"><code class="docutils literal notranslate"><span class="pre">hydFoil.Evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.FailedFitness"><code class="docutils literal notranslate"><span class="pre">hydFoil.FailedFitness()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.Geometry"><code class="docutils literal notranslate"><span class="pre">hydFoil.Geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.GeometryMesh"><code class="docutils literal notranslate"><span class="pre">hydFoil.GeometryMesh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.H_"><code class="docutils literal notranslate"><span class="pre">hydFoil.H_</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.L_"><code class="docutils literal notranslate"><span class="pre">hydFoil.L_</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.Mesh"><code class="docutils literal notranslate"><span class="pre">hydFoil.Mesh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.R_"><code class="docutils literal notranslate"><span class="pre">hydFoil.R_</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.Simulate"><code class="docutils literal notranslate"><span class="pre">hydFoil.Simulate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.aF"><code class="docutils literal notranslate"><span class="pre">hydFoil.aF</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.aG"><code class="docutils literal notranslate"><span class="pre">hydFoil.aG</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.bC"><code class="docutils literal notranslate"><span class="pre">hydFoil.bC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.bV"><code class="docutils literal notranslate"><span class="pre">hydFoil.bV</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.cV"><code class="docutils literal notranslate"><span class="pre">hydFoil.cV</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.c_mi_"><code class="docutils literal notranslate"><span class="pre">hydFoil.c_mi_</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.container"><code class="docutils literal notranslate"><span class="pre">hydFoil.container</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.dC"><code class="docutils literal notranslate"><span class="pre">hydFoil.dC</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.dP"><code class="docutils literal notranslate"><span class="pre">hydFoil.dP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.nB_"><code class="docutils literal notranslate"><span class="pre">hydFoil.nB_</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.n_"><code class="docutils literal notranslate"><span class="pre">hydFoil.n_</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.state_"><code class="docutils literal notranslate"><span class="pre">hydFoil.state_</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.sys"><code class="docutils literal notranslate"><span class="pre">hydFoil.sys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hydFoilOpt.build.hydFoil.twoPiRByNB_"><code class="docutils literal notranslate"><span class="pre">hydFoil.twoPiRByNB_</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">C++ API documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ihs-ustutt/dtOO">Back to GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dtOO</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Demonstration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/demonstration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="demonstration">
<h1>Demonstration<a class="headerlink" href="#demonstration" title="Link to this heading"></a></h1>
<p>Documentation of the demonstration cases located in
<a class="reference external" href="https://github.com/ihs-ustutt/dtOO/tree/main/demo">demo</a>.</p>
<section id="kinetic-turbine-canada">
<h2>Kinetic Turbine <code class="docutils literal notranslate"><span class="pre">canada</span></code><a class="headerlink" href="#kinetic-turbine-canada" title="Link to this heading"></a></h2>
<p>The free-flow machine is shown in <a class="reference internal" href="#canada-over"><span class="std std-numref">Fig. 1</span></a>. The entire diffuser
and the shrouding in the guide vane and runner area have a constant wall
thickness.  The guide vanes in the figure (top left) are arranged downwards and
have a V-shape with an angle of 72°. The runner blades are positioned next to
them in downstream direction.  The diffuser has a constant maximum height.
Therefore, the arrangement of the three-parted diffuser has no section
projected to the flow direction in the upper and lower areas. The figure shows
the vents oriented towards the axis of rotation in the upper area (top right)
and the vents pointing away from the axis of rotation on the side (bottom
left). The edges at the end of a corresponding diffuser section is straight.
The hub is spherical in front of the guide vane inlet and conical at the
diffuser inlet. For the design, only runner and diffuser are variable; the
guide vane is fixed and does not direct the flow. As a result, the inflow to
the runner is swirl-free.</p>
<figure class="align-center" id="id1">
<span id="canada-over"></span><a class="reference internal image-reference" href="_images/canada_over_nobg.png"><img alt="_images/canada_over_nobg.png" src="_images/canada_over_nobg.png" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Three-dimensional representation of the kinetic turbine (top left) with two
guide vanes arranged at the bottom and four rotor blades; diffuser is
designed in three parts; machine’s side view without blades (top right);
view from the front (bottom left); top view without blades (bottom right)</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#canada-res"><span class="std std-numref">Fig. 2</span></a> shows a simulation result of an optimized machine. The
streamlines are coloured with the velocity magnitude. Backflow regions are
visulaized as magenta coloured iso volumes. According to figure
<a class="reference internal" href="#canada-res"><span class="std std-numref">Fig. 2</span></a>, the flow enters the machine through the inlet section
and, additionally, through the vents. Behind the hub only small vortices occur.
The flow follows the opening of the diffuser. According to theoretical
considerations, the optimized machine shows a flap at the end of the third
diffuser section.</p>
<figure class="align-center" id="id2">
<span id="canada-res"></span><a class="reference internal image-reference" href="_images/canada_res_nobg.png"><img alt="_images/canada_res_nobg.png" src="_images/canada_res_nobg.png" style="width: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Three-dimensional representation of the kinetic turbine including the
simulated flow field; streamlines are coloured with the velocity magnitude
from low (blue) to high (red); backflow volume shown as magenta coloured iso
volume;</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference external" href="http://dx.doi.org/10.18419/opus-11091">[Tismer_2020]</a> contains a more
detailed description including a documented optimization.
<a class="reference external" href="http://dx.doi.org/10.18419/opus-13951">[Mastaller_2023]</a> gives additional
theoretical background and unsteady simulation results of an optimized
candidate.</p>
<section id="parameterization">
<h3>Parameterization<a class="headerlink" href="#parameterization" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="#canada-dt-para"><span class="std std-numref">Fig. 3</span></a> shows the parameterization of the diffuser geometry.
The guide vane and runner area is marked by the rectangle drawn as a dash-dot
line. For the design of the kinetic turbine, the control points shown are fixed
(empty rectangles) or movable (filled rectangles). Each gray edge of the
diffuser is defined by a B-spline of second order. The first and last spline
each have three movable and one fixed control point. The former fulfills the
constraint of a smooth transition from the guide vane and runner area to the
diffuser shape, the latter limits the horizontal (<span class="math notranslate nohighlight">\(x\)</span>-direction)
expansion of the diffuser. The transition from guide vane and runner area to
the diffuser is made differentiable by fixing the second control point in the
<span class="math notranslate nohighlight">\(x\)</span>-direction. All three control points in the second diffuser section
can move. The first point at each of the first and third diffuser part can only
be move in the <span class="math notranslate nohighlight">\(x\)</span>-direction.  The overlap in <span class="math notranslate nohighlight">\(z\)</span>-direction of the
parts is fixed. Overall, the diffuser is parameterized with <span class="math notranslate nohighlight">\(15\)</span> degrees
of freedom (DOF). In the following, DOFs in the <span class="math notranslate nohighlight">\(x\)</span>-direction are denoted
by <span class="math notranslate nohighlight">\(E_{p,q}\)</span> and in the <span class="math notranslate nohighlight">\(z\)</span>-direction by <span class="math notranslate nohighlight">\(L_{p,q}\)</span>.  With the
index <span class="math notranslate nohighlight">\(p\)</span>, the first, second and third diffuser section is characterized
by the indices <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span>, respectively.  The second
index <span class="math notranslate nohighlight">\(q\)</span> corresponds to the first to fourth and first to third control
points per diffuser part by the indices <span class="math notranslate nohighlight">\(0.0\)</span>, <span class="math notranslate nohighlight">\(1.0\)</span>, <span class="math notranslate nohighlight">\(1.5\)</span>
and <span class="math notranslate nohighlight">\(2.0\)</span> and <span class="math notranslate nohighlight">\(0.0\)</span>, <span class="math notranslate nohighlight">\(1.0\)</span> and <span class="math notranslate nohighlight">\(2.0\)</span>, respectively.</p>
<p><a class="reference internal" href="#canada-dt-para"><span class="std std-numref">Fig. 3</span></a> also contains parts of the unstructured mesh blocks
(black solid line). The remaining space within the investigated area (black
dotted line) is meshed with a block structured grid. In this case, the hybrid
mesh reduces the number of cells and the complexity of the block structure. An
adequate number of elements is required upstream and downstream of the hub,
which is, in case of a pure block structured approach, completely imprinted on
the inflow section. Due to the small hub in relation to the diffuser, fewer
elements are generally required near the hub than on the diffuser. The
unstructured areas decouple the mesh. In addition, the geometric deformation of
the diffuser mesh in the <span class="math notranslate nohighlight">\(x\)</span>-direction can be compensated by tightening
the inner blocks. This results in more tetrahedral elements; at the same time,
the hexahedrons remain more uniform in the structured areas.</p>
<figure class="align-center" id="id3">
<span id="canada-dt-para"></span><a class="reference internal image-reference" href="_images/canada_dt_para_nobg.png"><img alt="_images/canada_dt_para_nobg.png" src="_images/canada_dt_para_nobg.png" style="width: 500px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Schematic representation of the kinetic turbine in half-sided view with
boundaries (gray) and the bladed space (black dash-dotted line); control
points (rectangles) are fixed (empty) or moveable (filled); unstructured
grid blocks drawn as black solid line; coupling (black dotted line) to the
coarsely meshed far-field via a general grid interface</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#canada-ru-para"><span class="std std-numref">Fig. 4</span></a> contains the parameterization of a mid-surface section
for the runner. Each section is defined by four DOFs. The outlet angle
<span class="math notranslate nohighlight">\(\beta_o\)</span> and the position (sickling) in the circumferential direction
<span class="math notranslate nohighlight">\(\phi r_o\)</span> can be changed. The index <span class="math notranslate nohighlight">\(o\)</span> defines the position of
the cut in the spanwise direction. The distribution of the thickness is</p>
<div class="math notranslate nohighlight" id="equation-naca-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-naca-eq" title="Link to this equation"></a></span>\[y(t,T) = T \left(
    0.2969 \sqrt{t}
  − 0.1260 t
  − 0.3516 t^2
  + 0.2843 t^3
  − 0.1015t^4
  − 0.0021t^4
\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> follows the parameter value of the meanline. Additionally, the
parameter <span class="math notranslate nohighlight">\(X\)</span> (not shown in figure) shifts the maximum thickness
<span class="math notranslate nohighlight">\(T\)</span> to the inlet or outlet. This means that only symmetrical thickenings
can be generated.</p>
<figure class="align-center" id="id4">
<span id="canada-ru-para"></span><a class="reference internal image-reference" href="_images/canada_ru_para_nobg.png"><img alt="_images/canada_ru_para_nobg.png" src="_images/canada_ru_para_nobg.png" style="width: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Control polygon (black dashed) of the center line (black solid) with fixed
(empty) and movable (filled) control points; entry and exit angles
<span class="math notranslate nohighlight">\(\alpha_o\)</span> and <span class="math notranslate nohighlight">\(\beta_o\)</span> as well as deflection <span class="math notranslate nohighlight">\(r_o\)</span> can
be changed; position of the cut in circumferential direction can be changed
via DOF <span class="math notranslate nohighlight">\(\phi r_o\)</span></span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The runner blade is generated from three sections parameterized according to
<a class="reference internal" href="#canada-ru-para"><span class="std std-numref">Fig. 4</span></a>. <a class="reference internal" href="#canada-ru3d-para"><span class="std std-numref">Fig. 5</span></a> shows a schematic sketch
of the three-dimensional blade. Visible edges are shown as thick black lines,
hidden edges as thin gray lines and mid-surface sections as dotted lines. The
three directions <span class="math notranslate nohighlight">\(\phi r\)</span>, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(r\)</span> correspond to the
arrows on the hub. The sections at the hub (<span class="math notranslate nohighlight">\(s=0\)</span>), center
(<span class="math notranslate nohighlight">\(s=0.5\)</span>) and shroud (<span class="math notranslate nohighlight">\(s=1\)</span>) or index <span class="math notranslate nohighlight">\(o=0\)</span>, <span class="math notranslate nohighlight">\(o=1\)</span> and
<span class="math notranslate nohighlight">\(o=2\)</span> are connected by a B-Spline surface.  According to
<a class="reference internal" href="#canada-ru3d-para"><span class="std std-numref">Fig. 5</span></a>, the span direction is not necessarily the radial
direction.</p>
<figure class="align-center" id="id5">
<span id="canada-ru3d-para"></span><a class="reference internal image-reference" href="_images/canada_ru3d_para_nobg.png"><img alt="_images/canada_ru3d_para_nobg.png" src="_images/canada_ru3d_para_nobg.png" style="width: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Three-dimensional view of the impeller blade from three sections; hub
section (thin black) with corresponding directional arrows; span direction
of the blade (dashed directional arrow); visible (thick black) and hidden
(thin gray) edges (solid); mean sections (dotted) shown for each section</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The maximum thickening <span class="math notranslate nohighlight">\(T\)</span> of the mean line or mean surface from equation
<a class="reference internal" href="#equation-naca-eq">(1)</a> is variable in spanwise direction. A blending</p>
<div class="math notranslate nohighlight">
\[T(s) = T_0 + (T_1 - T_0) h(s)\]</div>
<p>with the blending function <span class="math notranslate nohighlight">\(h(s)\)</span> is defined by the fixed maximum
thickenings <span class="math notranslate nohighlight">\(T_0\)</span> and <span class="math notranslate nohighlight">\(T_1\)</span> at the hub and shroud.
<a class="reference internal" href="#canada-ru-blending"><span class="std std-numref">Fig. 6</span></a> visualizes the function</p>
<div class="math notranslate nohighlight">
\[h(s)
=
c_0
-
c_1 \frac{
  \mathrm{tanh} \left( G (sC - 1) \right)
}
{
  \mathrm{tanh}(G)
}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[c_0
=
\frac{
  \mathrm{tanh} G
}
{
  \mathrm{tanh} \left( G (C - 1) \right) + \mathrm{tanh} G
}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[c_1 = - \frac{\mathrm{tanh} G}{\mathrm{tanh} [G(C - 1)] + \mathrm{tanh} G}\]</div>
<p>for different parameter values of <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(C\)</span>. For <span class="math notranslate nohighlight">\(G = 0.01\)</span>
and <span class="math notranslate nohighlight">\(C = 2\)</span>, the result is a linear blending that corresponds to the
black dots. An increase in <span class="math notranslate nohighlight">\(G\)</span> bulges the blending symmetrically and
makes it “s”-shaped according to the dashed lines from white to black. Changing
<span class="math notranslate nohighlight">\(C\)</span> creates an asymmetrical blending in the direction of the hub or
shroud (color gradient from dark to light). The steeper the gradient of
<span class="math notranslate nohighlight">\(h(s)\)</span>, the faster the change in thickening in the spanwise direction.</p>
<figure class="align-center" id="id6">
<span id="canada-ru-blending"></span><a class="reference internal image-reference" href="_images/canada_ru_blending_nobg.png"><img alt="_images/canada_ru_blending_nobg.png" src="_images/canada_ru_blending_nobg.png" style="width: 250px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Blending function of the thickness distribution; linear blending shown as
black dots; variation of <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(C\)</span> shown by dashed lines and
color gradient, respectively</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="parameter-symbols-and-labels">
<h4>Parameter symbols and labels<a class="headerlink" href="#parameter-symbols-and-labels" title="Link to this heading"></a></h4>
<p><a class="reference internal" href="#map-dof-lab"><span class="std std-numref">Table 1</span></a> gives the mapping between math symbols and
<a class="reference internal" href="constValue.html#constvalue"><span class="std std-ref">constValue</span></a> labels. Additionally, the min and max value for each DOF is
shown. It is important to mention that all DOFs are scaled. Therefore, the
values does not directly correspond to the dimension of an angle or a length.</p>
<span id="map-dof-lab"></span><table class="docutils align-center" id="id7">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Mapping between math symbol and <a class="reference internal" href="constValue.html#constvalue"><span class="std std-ref">constValue</span></a> label for DOFs
            including min and max values</span><a class="headerlink" href="#id7" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 40.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Label</p></th>
<th class="head"><p>Min</p></th>
<th class="head"><p>Max</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(r_0\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_ratio_0.0</span></code></p></td>
<td><p>0.05</p></td>
<td><p>0.8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(r_1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_ratio_0.5</span></code></p></td>
<td><p>0.2</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(r_2\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_ratio_1.0</span></code></p></td>
<td><p>0.2</p></td>
<td><p>0.8</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\phi r_0\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_offsetPhiR_ex_0.0</span></code></p></td>
<td><p>-0.04</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\phi r_1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_offsetPhiR_ex_0.5</span></code></p></td>
<td><p>-0.04</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\phi r_2\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_offsetPhiR_ex_1.0</span></code></p></td>
<td><p>-0.04</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha_1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_alpha_1_ex_0.0</span></code></p></td>
<td><p>-0.2</p></td>
<td><p>0.3</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha_2\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_alpha_1_ex_0.5</span></code></p></td>
<td><p>-0.2</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha_3\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_alpha_1_ex_1.0</span></code></p></td>
<td><p>-0.2</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_alpha_2_ex_0.0</span></code></p></td>
<td><p>-0.2</p></td>
<td><p>0.3</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_2\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_alpha_2_ex_0.5</span></code></p></td>
<td><p>-0.2</p></td>
<td><p>0.3</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_3\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_ru_alpha_2_ex_1.0</span></code></p></td>
<td><p>-0.2</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta L_{0,1}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaL_dt_1</span></code></p></td>
<td><p>-0.10</p></td>
<td><p>0.6</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta L_{0,1.5}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaL_dt_1.5</span></code></p></td>
<td><p>0.1</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta E_{0,1.5}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt_1.5</span></code></p></td>
<td><p>0.05</p></td>
<td><p>0.7</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta E_{0,2}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt_2</span></code></p></td>
<td><p>0.05</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta L_{1,0}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaL_dt2_0</span></code></p></td>
<td><p>0.2</p></td>
<td><p>0.4</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta L_{1,1}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaL_dt2_1</span></code></p></td>
<td><p>0.1</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta E_{1,0}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt2_0</span></code></p></td>
<td><p>0.05</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta E_{1,1}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt2_1</span></code></p></td>
<td><p>-0.10</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta E_{1,2}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt2_2</span></code></p></td>
<td><p>0.1</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta L_{2,0}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaL_dt3_0</span></code></p></td>
<td><p>0.3</p></td>
<td><p>0.72</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta L_{2,1}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaL_dt3_1</span></code></p></td>
<td><p>0.1</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta E_{2,0}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt3_0</span></code></p></td>
<td><p>0.05</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta E_{2,1}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt3_1</span></code></p></td>
<td><p>-0.10</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Delta L_{2,1.5}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaL_dt3_1.5</span></code></p></td>
<td><p>0.25</p></td>
<td><p>0.99</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta E_{2,1.5}\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_deltaE_dt3_1.5</span></code></p></td>
<td><p>0.25</p></td>
<td><p>0.99</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(X\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_thick_x</span></code></p></td>
<td><p>0.20</p></td>
<td><p>0.8</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(G\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_thick_g</span></code></p></td>
<td><p>0.01</p></td>
<td><p>5.0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(C\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cV_thick_c_3</span></code></p></td>
<td><p>0.30</p></td>
<td><p>3.0</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="simulation-setup">
<h3>Simulation setup<a class="headerlink" href="#simulation-setup" title="Link to this heading"></a></h3>
<p>The simulation area of the kinetic turbine consists of an area close to the
turbine and a far-field. <a class="reference internal" href="#canada-case-over"><span class="std std-numref">Fig. 7</span></a> shows the calculation area
schematically. The far-field contains the dotted area near the turbine. A
Dirichlet boundary condition for the velocity and a gradient boundary condition
for the pressure are set at the inlet <span class="math notranslate nohighlight">\((E)\)</span>; correspondingly, a gradient
boundary condition and a Dirichlet boundary condition are specified at the
outlet <span class="math notranslate nohighlight">\((A)\)</span>.  The connection of the near-field with the far-field is
made via a generalized mesh interface at the coupling surfaces <span class="math notranslate nohighlight">\((F_1,
G_1)\)</span>, <span class="math notranslate nohighlight">\((F_2, G_2)\)</span> and <span class="math notranslate nohighlight">\((F_3, G_3)\)</span>. By meshing the two areas
separately, it is possible to mesh the far-field area more coarsely and, thus,
save computation time. The two boundary surfaces at the top and bottom of the
far-field (both summarized in <span class="math notranslate nohighlight">\((N)\)</span>) are defined as a frictionless wall.
The detail at the bottom right of <a class="reference internal" href="#canada-case-over"><span class="std std-numref">Fig. 7</span></a> shows the area
close to the turbine with the guide vane and runner area as well as the
subsequent diffuser. The guide vane, runner, hub and diffuser are only drawn in
half section due to symmetry. All <span class="math notranslate nohighlight">\((S)\)</span> boundary surfaces are walls with
a noslip condition. The part of the <span class="math notranslate nohighlight">\((S)\)</span> surface in the runner area (hub
and blade) rotates according to the angular velocity. The coupling surface
<span class="math notranslate nohighlight">\((F_4, G_4)\)</span> at the runner inlet is also a generalized mesh interface.
There is a mixing plane interface between the guide vane and runner
<span class="math notranslate nohighlight">\((L_5, M_5)\)</span> or runner and diffuser <span class="math notranslate nohighlight">\((L_6, M_6)\)</span>.</p>
<figure class="align-center" id="id8">
<span id="canada-case-over"></span><a class="reference internal image-reference" href="_images/canada_case_over_nobg.png"><img alt="_images/canada_case_over_nobg.png" src="_images/canada_case_over_nobg.png" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Schematic representation of the simulation area consisting of near-field
(dotted cone) and far-field (dashed rectangle); boundary conditions shown on
boundary surfaces (letters without indices) and coupling surfaces (letters
with indices); guide vane (LE) and runner (LA) area including diffuser and
hub (both dashed gray) in detail</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="running-the-case">
<h3>Running the case<a class="headerlink" href="#running-the-case" title="Link to this heading"></a></h3>
<p>Pull and run the latest stable container by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>pull<span class="w"> </span>atismer/dtoo:stable
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>atismer/dtoo:stable
</pre></div>
</div>
<p>Change to the case directory by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>/dtOO/demo/canada
</pre></div>
</div>
<p>and list the files in the directory by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls
E1_12685.xml<span class="w">  </span>Mesh<span class="w">  </span>build.py<span class="w">  </span>geo<span class="w">  </span>gmshMeshFile<span class="w">  </span>init.xml<span class="w">  </span>machine.xml<span class="w">  </span>machineSave.xml<span class="w">  </span>xml
</pre></div>
</div>
<p>The kinetic turbine is setup with the old XML (Extensible Markup Language)
interface of the framework. Therefore, the main XML file <code class="docutils literal notranslate"><span class="pre">machine.xml</span></code>, the
state files <code class="docutils literal notranslate"><span class="pre">machineSave.xml</span></code> and <code class="docutils literal notranslate"><span class="pre">E1_12685.xml</span></code> as well as the files
located in directory <code class="docutils literal notranslate"><span class="pre">xml</span></code> are necessary to create the machine. The <code class="docutils literal notranslate"><span class="pre">Mesh</span></code>
directory contains the fixed far-field mesh in CGNS format.</p>
<section id="using-build-py">
<h4>Using <code class="docutils literal notranslate"><span class="pre">build.py</span></code><a class="headerlink" href="#using-build-py" title="Link to this heading"></a></h4>
<p>The <a class="reference external" href="https://github.com/ihs-ustutt/dtOO/blob/main/demo/canada/build.py">Python script</a>
automatically creates the predefined state <code class="docutils literal notranslate"><span class="pre">E1_12685</span></code> of the kinetic turbine.
It is executed within the container by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>build.py
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You have to set two MPI environment variables.  This is necessary because
within the container you are <code class="docutils literal notranslate"><span class="pre">root</span></code>. This has to be done before running
any simulation by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_ALLOW_RUN_AS_ROOT</span><span class="o">=</span><span class="m">1</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OMPI_ALLOW_RUN_AS_ROOT_CONFIRM</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</div>
<section id="description-of-build-py">
<h5>Description of <code class="docutils literal notranslate"><span class="pre">build.py</span></code><a class="headerlink" href="#description-of-build-py" title="Link to this heading"></a></h5>
<p>The first part of the script controls the framework. First the framework is
imported with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dtOOPythonSWIG</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>and the log file <code class="docutils literal notranslate"><span class="pre">build.log</span></code> is created with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logMe</span><span class="o">.</span><span class="n">initLog</span><span class="p">(</span><span class="s2">&quot;build.log&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As previously mentioned, the kinetic turbine is created using the XML
interface. The input and state XML file is loaded by the parser with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dtXmlParser</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;machine.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;E1_12685.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>and a reference to the parser is kept in the variable <code class="docutils literal notranslate"><span class="pre">parser</span></code> by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">dtXmlParser</span><span class="o">.</span><span class="n">reference</span><span class="p">()</span>
</pre></div>
</div>
<p>Afterwards both XML files are parsed</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
</pre></div>
</div>
<p>and the construction plan (XML files) of the machine is read. All objects are
stored in STL (C++ Standard Template Library) like objects. And those objects
have to be created for base ojects, DOFs, functions, geometries, mesh parts,
simulation cases and plugins by, respectively,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bC</span> <span class="o">=</span> <span class="n">baseContainer</span><span class="p">()</span>
<span class="n">cV</span> <span class="o">=</span> <span class="n">labeledVectorHandlingConstValue</span><span class="p">()</span>
<span class="n">aF</span> <span class="o">=</span> <span class="n">labeledVectorHandlingAnalyticFunction</span><span class="p">()</span>
<span class="n">aG</span> <span class="o">=</span> <span class="n">labeledVectorHandlingAnalyticGeometry</span><span class="p">()</span>
<span class="n">bV</span> <span class="o">=</span> <span class="n">labeledVectorHandlingBoundedVolume</span><span class="p">()</span>
<span class="n">dC</span> <span class="o">=</span> <span class="n">labeledVectorHandlingDtCase</span><span class="p">()</span>
<span class="n">dP</span> <span class="o">=</span> <span class="n">labeledVectorHandlingDtPlugin</span><span class="p">()</span>
</pre></div>
</div>
<p>before objects can be appended to the containers. All DOFs are created by the
member function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">createConstValue</span><span class="p">(</span><span class="n">cV</span><span class="p">)</span>
</pre></div>
</div>
<p>The specific state (put simply: the values of the DOFs) is loaded to the DOFs
by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">loadStateToConst</span><span class="p">(</span><span class="s2">&quot;E1_12685&quot;</span><span class="p">,</span> <span class="n">cV</span><span class="p">)</span>
</pre></div>
</div>
<p>All other objects are created by executing the command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">destroyAndCreate</span><span class="p">(</span><span class="n">bC</span><span class="p">,</span> <span class="n">cV</span><span class="p">,</span> <span class="n">aF</span><span class="p">,</span> <span class="n">aG</span><span class="p">,</span> <span class="n">bV</span><span class="p">,</span> <span class="n">dC</span><span class="p">,</span> <span class="n">dP</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, the complete machine is available within the containers. The last
step is to create the meshes and setup the simulation case by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dC</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ingvrudtout_coupled_of&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">runCurrentState</span><span class="p">()</span>
</pre></div>
</div>
<p>This step may take time, because the whole meshing procedure is performed.</p>
<p>The second part is the simulation of the flow field using OpenFOAM. In order to
also handle this in Python, the PyFoam library is used. The import of the
packages</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PyFoam.Applications.Decomposer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Decomposer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyFoam.Applications.WriteDictionary</span><span class="w"> </span><span class="kn">import</span> <span class="n">WriteDictionary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyFoam.Applications.Runner</span><span class="w"> </span><span class="kn">import</span> <span class="n">Runner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyFoam.Applications.ClearCase</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClearCase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyFoam.Applications.PackCase</span><span class="w"> </span><span class="kn">import</span> <span class="n">PackCase</span>
</pre></div>
</div>
<p>and definition of the case and state name</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">caseName</span> <span class="o">=</span> <span class="s2">&quot;ingvrudtout_coupled_of&quot;</span>
<span class="n">stateName</span> <span class="o">=</span> <span class="s2">&quot;E1_12685&quot;</span>
</pre></div>
</div>
<p>provides the necessary functions and attributes to correctly call PyFoam. For
the kinetic turbine the simulation cases are created as folders according to
the pattern:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ingvrudtout_coupled_of_&lt;stateLabel&gt;
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;stateLabel&gt;</span></code> represents the name of the currently loaded state. At first,
the case is decomposed by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Decomposer</span><span class="p">(</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span>
    <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="p">,</span><span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;--method=scotch&quot;</span><span class="p">,</span><span class="s2">&quot;--clear&quot;</span><span class="p">,</span><span class="s2">&quot;--silent&quot;</span>
  <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>and then ready to simulate the first 100 iterations as a laminar problem by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WriteDictionary</span><span class="p">(</span>
   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="o">+</span><span class="s2">&quot;/system/controlDict&quot;</span><span class="p">,</span> <span class="s2">&quot;endTime&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">]</span>
 <span class="p">)</span>
 <span class="n">WriteDictionary</span><span class="p">(</span>
   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="o">+</span><span class="s2">&quot;/system/controlDict&quot;</span><span class="p">,</span> <span class="s2">&quot;writeInterval&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">]</span>
 <span class="p">)</span>
 <span class="n">WriteDictionary</span><span class="p">(</span>
   <span class="n">args</span><span class="o">=</span><span class="p">[</span>
     <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="o">+</span><span class="s2">&quot;/constant/turbulenceProperties&quot;</span><span class="p">,</span>
     <span class="s2">&quot;RAS[&#39;turbulence&#39;]&quot;</span><span class="p">,</span>
     <span class="s2">&quot;off&quot;</span>
   <span class="p">]</span>
 <span class="p">)</span>
 <span class="n">Runner</span><span class="p">(</span>
   <span class="n">args</span><span class="o">=</span><span class="p">[</span>
     <span class="s2">&quot;--silent&quot;</span><span class="p">,</span>
     <span class="s2">&quot;--autosense-parallel&quot;</span><span class="p">,</span>
     <span class="s2">&quot;simpleFoam&quot;</span><span class="p">,</span> <span class="s2">&quot;-case&quot;</span><span class="p">,</span> <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span>
   <span class="p">]</span>
 <span class="p">)</span>
</pre></div>
</div>
<p>The second step is the simulation of the following 900 iterations as a
turbulent problem by executing</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WriteDictionary</span><span class="p">(</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="o">+</span><span class="s2">&quot;/system/controlDict&quot;</span><span class="p">,</span>
    <span class="s2">&quot;endTime&quot;</span><span class="p">,</span> <span class="s2">&quot;1000&quot;</span>
  <span class="p">]</span>
<span class="p">)</span>
<span class="n">WriteDictionary</span><span class="p">(</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span>
    <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="o">+</span><span class="s2">&quot;/system/controlDict&quot;</span><span class="p">,</span>
    <span class="s2">&quot;writeInterval&quot;</span><span class="p">,</span> <span class="s2">&quot;1000&quot;</span>
  <span class="p">]</span>
<span class="p">)</span>
<span class="n">WriteDictionary</span><span class="p">(</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span>
    <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="o">+</span><span class="s2">&quot;/constant/turbulenceProperties&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RAS[&#39;turbulence&#39;]&quot;</span><span class="p">,</span> <span class="s2">&quot;on&quot;</span>
  <span class="p">]</span>
<span class="p">)</span>
<span class="n">Runner</span><span class="p">(</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span>
    <span class="s2">&quot;--silent&quot;</span><span class="p">,</span>
    <span class="s2">&quot;--autosense-parallel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;simpleFoam&quot;</span><span class="p">,</span> <span class="s2">&quot;-case&quot;</span><span class="p">,</span> <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span>
  <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Runner</span><span class="p">(</span>
  <span class="n">args</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;--silent&#39;</span><span class="p">,</span>
    <span class="s1">&#39;reconstructPar&#39;</span><span class="p">,</span> <span class="s1">&#39;-latestTime&#39;</span><span class="p">,</span> <span class="s2">&quot;-case&quot;</span><span class="p">,</span> <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span>
  <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>to reconstruct the parallel simulation case. The two commands</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ClearCase</span><span class="p">(</span>
  <span class="p">[</span>
    <span class="s1">&#39;--keep-postprocessing&#39;</span><span class="p">,</span>
    <span class="s1">&#39;--processors-remove&#39;</span><span class="p">,</span>
    <span class="s1">&#39;--remove-analyzed&#39;</span><span class="p">,</span>
    <span class="s1">&#39;--keep-postprocessing&#39;</span><span class="p">,</span>
    <span class="s1">&#39;--clear-history&#39;</span><span class="p">,</span>
    <span class="s1">&#39;--keep-last&#39;</span><span class="p">,</span>
    <span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span>
  <span class="p">])</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">PackCase</span><span class="p">([</span><span class="n">caseName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">stateName</span><span class="p">,</span> <span class="s1">&#39;--last&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>are optional. They clear and pack the simulation case. This is useful when
performing an optimization to save disk space.</p>
</section>
</section>
<section id="creating-an-own-state">
<h4>Creating an own state<a class="headerlink" href="#creating-an-own-state" title="Link to this heading"></a></h4>
<p>The creation of a new state of the kinetic turbine starts with some already
described functions of <code class="docutils literal notranslate"><span class="pre">build.py</span></code>. At first, the framework, the parser and
the containers have to be defined by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dtOOPythonSWIG</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="n">logMe</span><span class="o">.</span><span class="n">initLog</span><span class="p">(</span><span class="s2">&quot;build.log&quot;</span><span class="p">)</span>
<span class="n">dtXmlParser</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;machine.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;E1_12685.xml&quot;</span><span class="p">)</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">dtXmlParser</span><span class="o">.</span><span class="n">reference</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<span class="n">bC</span> <span class="o">=</span> <span class="n">baseContainer</span><span class="p">()</span>
<span class="n">cV</span> <span class="o">=</span> <span class="n">labeledVectorHandlingConstValue</span><span class="p">()</span>
<span class="n">aF</span> <span class="o">=</span> <span class="n">labeledVectorHandlingAnalyticFunction</span><span class="p">()</span>
<span class="n">aG</span> <span class="o">=</span> <span class="n">labeledVectorHandlingAnalyticGeometry</span><span class="p">()</span>
<span class="n">bV</span> <span class="o">=</span> <span class="n">labeledVectorHandlingBoundedVolume</span><span class="p">()</span>
<span class="n">dC</span> <span class="o">=</span> <span class="n">labeledVectorHandlingDtCase</span><span class="p">()</span>
<span class="n">dP</span> <span class="o">=</span> <span class="n">labeledVectorHandlingDtPlugin</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">createConstValue</span><span class="p">(</span><span class="n">cV</span><span class="p">)</span>
</pre></div>
</div>
<p>It is good practice to start from an existing state. Therefore, we use the
<code class="docutils literal notranslate"><span class="pre">E1_12685</span></code> state as initialization for all DOFs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">loadStateToConst</span><span class="p">(</span><span class="s2">&quot;E1_12685&quot;</span><span class="p">,</span> <span class="n">cV</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point the DOFs are created and initialized. It can also be validated by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">currentState</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;E1_12685&#39;</span>
</pre></div>
</div>
<p>The output is exactly the loaded state. We can start to modify any
<a class="reference internal" href="constValue.html#constvalue"><span class="std std-ref">constValue</span></a> listed in <a class="reference internal" href="#map-dof-lab"><span class="std std-numref">Table 1</span></a>. One can easily iterate over
all defined DOFs within a simple <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cV</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">getLabel</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cV_n</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cV_ru_alpha_1_ex_0</span><span class="mf">.0</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cV_ru_stepNResplinePoints</span>
</pre></div>
</div>
<p>Somewhere in the long list we found the inlet angle at the hub that is
labelled as <code class="docutils literal notranslate"><span class="pre">cV_ru_alpha_1_ex_0.0</span></code> according to <a class="reference internal" href="#map-dof-lab"><span class="std std-numref">Table 1</span></a>. A
call of the <code class="docutils literal notranslate"><span class="pre">()</span></code>-operator</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cV</span><span class="p">[</span><span class="s2">&quot;cV_ru_alpha_1_ex_0.0&quot;</span><span class="p">]()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mf">0.04964900016784668</span>
</pre></div>
</div>
<p>gives the current value of the DOF. We can change the angle by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cV</span><span class="p">[</span><span class="s2">&quot;cV_ru_alpha_1_ex_0.0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>It is important to update the geometry of the runner mesh channel when the
blade geometry is changed. Otherwise the mesh might not be correctly generated.
The update is performed by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ru_adjustDomain&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</pre></div>
</div>
<p>Put simply, the command adjusts other  dependent DOFs to generate a valid mesh.
Checking again the state by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">currentState</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
<p>shows that the current state is empty. We create a new state and validate that
everything works correctly by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">setState</span><span class="p">(</span><span class="s2">&quot;iahr2024_state&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">currentState</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;iahr2024_state&#39;</span>
</pre></div>
</div>
<p>Optionally, we can extract the state and create a new state file by:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s2">&quot;iahr2024_state&quot;</span><span class="p">,</span> <span class="n">cV</span><span class="p">,</span> <span class="s2">&quot;iahr2024_state.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates the XML file <code class="docutils literal notranslate"><span class="pre">iahr2024_state.xml</span></code> within the directory. If no
new file is desired, a call to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cV</span><span class="p">)</span>
</pre></div>
</div>
<p>inserts the new state in the currently loaded state file (<code class="docutils literal notranslate"><span class="pre">E1_12685.xml</span></code>).
From this point, we can generate the whole machine by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parser</span><span class="o">.</span><span class="n">destroyAndCreate</span><span class="p">(</span><span class="n">bC</span><span class="p">,</span> <span class="n">cV</span><span class="p">,</span> <span class="n">aF</span><span class="p">,</span> <span class="n">aG</span><span class="p">,</span> <span class="n">bV</span><span class="p">,</span> <span class="n">dC</span><span class="p">,</span> <span class="n">dP</span><span class="p">)</span>
</pre></div>
</div>
<p>and create the case directory by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dC</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ingvrudtout_coupled_of&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">runCurrentState</span><span class="p">()</span>
</pre></div>
</div>
<p>Of course, we also have to adjust the variable names, if we still use the
above explained commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">caseName</span> <span class="o">=</span> <span class="s2">&quot;ingvrudtout_coupled_of&quot;</span>
<span class="n">stateName</span> <span class="o">=</span> <span class="s2">&quot;iahr2024_state&quot;</span>
</pre></div>
</div>
<p>Additionally, we have to simulate the new case written in the directory
<code class="docutils literal notranslate"><span class="pre">ingvrudtout_coupled_of_iahr2024_state</span></code>. This can be done with the above
described commands of PyFoam.</p>
</section>
</section>
</section>
<section id="module-hydFoilOpt.build">
<span id="optimization-of-a-hydrofoil"></span><h2>Optimization of a Hydrofoil<a class="headerlink" href="#module-hydFoilOpt.build" title="Link to this heading"></a></h2>
<p>This example optimizes a hydrofoil that is defined with 3 DOFs. The
optimization is performed with the differential evolution algorithm of
scipy.</p>
<p>It is necessary to set the OpenFoam environment variable “FOAM_SIGFPE” to
disable the handler. Otherwise the handler detects floating point exceptions
at the beginning. Additionally, the environment variable “OSLO_LOCKPATH”
is necessary to have a defined locking directory for the oslo.concurrency
library. Both variables are defined using the os package.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;FOAM_SIGFPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OSLO_LOCKPATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/tmp&quot;</span>
</pre></div>
</div>
<p>The optimizer is imported from scipy and the interested reader is refered to
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.differential_evolution.html#scipy.optimize.differential_evolution">[SciPy_2025]</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">differential_evolution</span>
</pre></div>
</div>
<p>The callback function <cite>optimizeHydFoil</cite> of the optimizer executes all steps
of the hydrofoil case. In the end, the fitness value of the hydrofoil is set
as return value of the callback. Additionally, an exception handling catches
all exceptions and returns a defined fitness value in case of an error.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">optimizeHydFoil</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">hf</span> <span class="o">=</span> <span class="n">hydFoil</span><span class="p">(</span> <span class="n">alpha_1</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha_2</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t_mid</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">... </span>    <span class="n">hf</span><span class="o">.</span><span class="n">Geometry</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hf</span><span class="o">.</span><span class="n">GeometryMesh</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hf</span><span class="o">.</span><span class="n">Mesh</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">hf</span><span class="o">.</span><span class="n">Simulate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">fit</span> <span class="o">=</span> <span class="n">hf</span><span class="o">.</span><span class="n">Evaluate</span><span class="p">()</span>
<span class="gp">... </span>  <span class="k">except</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Catch Exception&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">fit</span> <span class="o">=</span> <span class="n">hydFoil</span><span class="o">.</span><span class="n">FailedFitness</span><span class="p">()</span>
<span class="gp">... </span>  <span class="k">return</span> <span class="n">fit</span>
</pre></div>
</div>
<p>Define the bounds of the DOFs for the optimization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">150.0</span><span class="p">,</span> <span class="mf">170.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">155.0</span><span class="p">,</span> <span class="mf">175.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">),]</span>
</pre></div>
</div>
<p>Call the optimizer with the callback function. The number of candidates is
low to have a fast code example.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">differential_evolution</span><span class="p">(</span>
<span class="gp">... </span>  <span class="n">optimizeHydFoil</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">bounds</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">popsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">maxiter</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>  <span class="n">polish</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Output the final result of the optimization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<span class="gp">... </span>  <span class="s2">&quot;Optimum found at (alpha_1, alpha_2, t_mid) = (</span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">) with </span><span class="si">%f</span><span class="s2">&quot;</span>
<span class="gp">... </span>  <span class="o">%</span>
<span class="gp">... </span>  <span class="p">(</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span> <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hydFoilOpt.build.</span></span><span class="sig-name descname"><span class="pre">hydFoil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">130</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_mid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydFoilOpt/build.html#hydFoil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydFoilOpt.build.hydFoil" title="Link to this definition"></a></dt>
<dd><p>Create, mesh, simulate and evaluate a hydrofoil.</p>
<p>This class holds all functions to create a hydrofoil with an inlet angle,
outlet angle and a blade thickness. <a class="reference internal" href="#hydfoil"><span class="std std-numref">Fig. 8</span></a> shows a sketch of the
hydrofoil.</p>
<figure class="align-center" id="id9">
<span id="hydfoil"></span><a class="reference internal image-reference" href="_images/hydfoil.png"><img alt="_images/hydfoil.png" src="_images/hydfoil.png" style="width: 600px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Hydrofoil’s sketch including mean line (solid thick black line) and final
shape (solid thin black line); B-Splines, that are used for constructing
the meanline and final shape, are shown as solid and dashed gray thin
lines; velocity triangles at inlet and outlet of the hydrofoil are
colored in magenta; the DOFs, namely <span class="math notranslate nohighlight">\(\alpha_1\)</span>,
<span class="math notranslate nohighlight">\(\alpha_2\)</span>, and <span class="math notranslate nohighlight">\(t_{mid}\)</span>, are shown and labeled in black</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_1</strong> (<em>float</em>) – Inlet angle.</p></li>
<li><p><strong>alpha_2</strong> (<em>float</em>) – Outlet angle.</p></li>
<li><p><strong>t_mid</strong> (<em>float</em>) – Blade’s thickness.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.Evaluate">
<span class="sig-name descname"><span class="pre">Evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydFoilOpt/build.html#hydFoil.Evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydFoilOpt.build.hydFoil.Evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluate the simulation.</p>
<p>The simulation is evaluated using the pyDtOO library. Additionally, the
“patchToCsv” application is used to create csv files of the boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fitness value of this candidate.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.FailedFitness">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FailedFitness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydFoilOpt/build.html#hydFoil.FailedFitness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydFoilOpt.build.hydFoil.FailedFitness" title="Link to this definition"></a></dt>
<dd><p>Failed fitness.</p>
<p>Returns the value that represents a failed design.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fitness for a failed design.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.Geometry">
<span class="sig-name descname"><span class="pre">Geometry</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydFoilOpt/build.html#hydFoil.Geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydFoilOpt.build.hydFoil.Geometry" title="Link to this definition"></a></dt>
<dd><p>Create hyrdofoil’s geometry.</p>
<p>The main objects of baseContainer, analyticFunction, and analyticGeometry
are created. Objects that are necessary or interesting are appended to the
<a class="reference internal" href="#hydFoilOpt.build.hydFoil.bV" title="hydFoilOpt.build.hydFoil.bV"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hydFoilOpt.build.hydFoil.bV</span></code></a>, <a class="reference internal" href="#hydFoilOpt.build.hydFoil.aF" title="hydFoilOpt.build.hydFoil.aF"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hydFoilOpt.build.hydFoil.aF</span></code></a>,
and <a class="reference internal" href="#hydFoilOpt.build.hydFoil.aG" title="hydFoilOpt.build.hydFoil.aG"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hydFoilOpt.build.hydFoil.aG</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.GeometryMesh">
<span class="sig-name descname"><span class="pre">GeometryMesh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydFoilOpt/build.html#hydFoil.GeometryMesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydFoilOpt.build.hydFoil.GeometryMesh" title="Link to this definition"></a></dt>
<dd><p>Create additional hydrofoil’s geometry for meshing.</p>
<p>Create additional objects that are necessary for creating the mesh. These
are mainly object’s of the mesh block that is created around the blade.
This block is meshed as a structured block.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.H_">
<span class="sig-name descname"><span class="pre">H_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.H_" title="Link to this definition"></a></dt>
<dd><p>Height of the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.L_">
<span class="sig-name descname"><span class="pre">L_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.L_" title="Link to this definition"></a></dt>
<dd><p>Length of the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.Mesh">
<span class="sig-name descname"><span class="pre">Mesh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydFoilOpt/build.html#hydFoil.Mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydFoilOpt.build.hydFoil.Mesh" title="Link to this definition"></a></dt>
<dd><p>Create hydrofoil’s mesh.</p>
<p>Create the topology for the hydrofoil’s mesh. Additionally, define number
of elements for edges and surfaces, define minimum and maximum element
lengths for unstructured meshing algorithms, and label mesh parts.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.R_">
<span class="sig-name descname"><span class="pre">R_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.R_" title="Link to this definition"></a></dt>
<dd><p>Radius of the blade cut where this hydrofoil is located.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.Simulate">
<span class="sig-name descname"><span class="pre">Simulate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydFoilOpt/build.html#hydFoil.Simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydFoilOpt.build.hydFoil.Simulate" title="Link to this definition"></a></dt>
<dd><p>Perform the simulation.</p>
<p>Perform the simulation using foamlib. The simulation runs for 500
iterations as a laminar simulation. Afterwards, it is switched to turbulent
mode.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.aF">
<span class="sig-name descname"><span class="pre">aF</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.aF" title="Link to this definition"></a></dt>
<dd><p>Container object
of dtOOPythonSWIG.analyticFunction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.labeledVectorHandlingAnalyticFunction</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.aG">
<span class="sig-name descname"><span class="pre">aG</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.aG" title="Link to this definition"></a></dt>
<dd><p>Container object
of dtOOPythonSWIG.analyticGeometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.labeledVectorHandlingAnalyticGeometry</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.bC">
<span class="sig-name descname"><span class="pre">bC</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.bC" title="Link to this definition"></a></dt>
<dd><p>base container.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.baseContainer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.bV">
<span class="sig-name descname"><span class="pre">bV</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.bV" title="Link to this definition"></a></dt>
<dd><p>Container object
of dtOOPythonSWIG.boundedVolume.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.labeledVectorHandlingBoundedVolume</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.cV">
<span class="sig-name descname"><span class="pre">cV</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.cV" title="Link to this definition"></a></dt>
<dd><p>Container object
of dtOOPythonSWIG.constValue.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.labeledVectorHandlingConstValue</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.c_mi_">
<span class="sig-name descname"><span class="pre">c_mi_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.c_mi_" title="Link to this definition"></a></dt>
<dd><p>Absolute velocity at inlet in <span class="math notranslate nohighlight">\(\frac{m}{s}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.container">
<span class="sig-name descname"><span class="pre">container</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.container" title="Link to this definition"></a></dt>
<dd><p>Bundle object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.dtBundle</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.dC">
<span class="sig-name descname"><span class="pre">dC</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.dC" title="Link to this definition"></a></dt>
<dd><p>Container object
of dtOOPythonSWIG.dtCase.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.labeledVectorHandlingDtCase</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.dP">
<span class="sig-name descname"><span class="pre">dP</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.dP" title="Link to this definition"></a></dt>
<dd><p>Container object
of dtOOPythonSWIG.dtPlugin.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dtOOPythonSWIG.labeledVectorHandlingDtPlugin</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.nB_">
<span class="sig-name descname"><span class="pre">nB_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.nB_" title="Link to this definition"></a></dt>
<dd><p>Number of blades in which this hydrofoil is located.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.n_">
<span class="sig-name descname"><span class="pre">n_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.n_" title="Link to this definition"></a></dt>
<dd><p>Rotational speed in <span class="math notranslate nohighlight">\(min^{-1}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.state_">
<span class="sig-name descname"><span class="pre">state_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.state_" title="Link to this definition"></a></dt>
<dd><p>State label.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.sys">
<span class="sig-name descname"><span class="pre">sys</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;module</span> <span class="pre">'sys'</span> <span class="pre">(built-in)&gt;</span></em><a class="headerlink" href="#hydFoilOpt.build.hydFoil.sys" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hydFoilOpt.build.hydFoil.twoPiRByNB_">
<span class="sig-name descname"><span class="pre">twoPiRByNB_</span></span><a class="headerlink" href="#hydFoilOpt.build.hydFoil.twoPiRByNB_" title="Link to this definition"></a></dt>
<dd><p>Width of the mesh.</p>
<p>The width is given by the fraction of the unwounded length
<span class="math notranslate nohighlight">\(2 \pi R\)</span> and the number of blades <span class="math notranslate nohighlight">\(n_B\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="C++ API documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Alexander Tismer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>